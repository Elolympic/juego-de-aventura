<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pixel Art Adventure</title>
  <style>
    body { background: #000; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; color: #fff; font-family: sans-serif; }
    canvas { image-rendering: pixelated; }
    #hud { position: absolute; top: 10px; left: 10px; z-index: 10; }
  </style>
</head>
<body>
  <div id="hud">Tesoros: <span id="score">0</span>/<span id="total">0</span></div>
  <canvas id="gameCanvas"></canvas>
  <script>
    const TILE_SIZE = 16;
    const SCALE = 3;
    const WIDTH = 20;
    const HEIGHT = 15;
    const CANVAS_WIDTH = WIDTH * TILE_SIZE * SCALE;
    const CANVAS_HEIGHT = HEIGHT * TILE_SIZE * SCALE;

    const TILE = {
      FLOOR: 0,
      WALL: 1,
      TREE: 2,
      TREASURE: 3,
    };

    // Mapa de aventura: 0=suelo,1=muro,2=árbol,3=tesoro
    const map = [
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,2,0,0,0,0,0,0,2,0,0,3,1],
      [1,0,2,2,0,2,0,0,2,0,2,2,2,0,0,2,0,0,0,1],
      [1,0,0,0,0,0,0,0,2,0,0,0,2,0,0,0,0,2,0,1],
      [1,0,2,2,0,2,2,0,2,2,2,0,2,2,0,2,0,2,0,1],
      [1,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,1],
      [1,0,2,2,2,2,2,2,2,0,2,2,2,2,2,2,0,2,0,1],
      [1,0,0,0,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,1],
      [1,2,2,0,2,2,2,0,2,2,2,0,2,2,2,0,2,2,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,2,2,0,2,2,0,2,2,2,2,0,2,2,0,2,2,0,1],
      [1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    ];

    let score = 0;
    const totalTreasures = map.flat().filter(t => t === TILE.TREASURE).length;
    document.getElementById('total').textContent = totalTreasures;

    const canvas = document.getElementById('gameCanvas');
    canvas.width = CANVAS_WIDTH;
    canvas.height = CANVAS_HEIGHT;
    const ctx = canvas.getContext('2d');

    const player = { x: 2, y: 2, color: '#f00' };
    let dir = { dx: 0, dy: 0 };
    const keys = {};

    window.addEventListener('keydown', e => { keys[e.key] = true; updateDirection(); });
    window.addEventListener('keyup', e => { keys[e.key] = false; updateDirection(); });

    function updateDirection() {
      if (keys['ArrowUp']) dir = { dx: 0, dy: -1 };
      else if (keys['ArrowDown']) dir = { dx: 0, dy: 1 };
      else if (keys['ArrowLeft']) dir = { dx: -1, dy: 0 };
      else if (keys['ArrowRight']) dir = { dx: 1, dy: 0 };
      else dir = { dx: 0, dy: 0 };
    }

    function update() {
      const nx = player.x + dir.dx;
      const ny = player.y + dir.dy;
      const tile = map[ny]?.[nx];
      if (tile === TILE.FLOOR || tile === TILE.TREASURE) {
        player.x = nx;
        player.y = ny;
        if (tile === TILE.TREASURE) {
          score++;
          map[ny][nx] = TILE.FLOOR;
          document.getElementById('score').textContent = score;
          if (score === totalTreasures) {
            setTimeout(() => alert('¡Has recolectado todos los tesoros!'), 100);
          }
        }
      }
    }

    function draw() {
      ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
      for (let y = 0; y < HEIGHT; y++) {
        for (let x = 0; x < WIDTH; x++) {
          const t = map[y][x];
          if (t === TILE.WALL) ctx.fillStyle = '#444';
          else if (t === TILE.TREE) ctx.fillStyle = '#060';
          else if (t === TILE.TREASURE) ctx.fillStyle = '#ff0';
          else ctx.fillStyle = '#888';
          ctx.fillRect(x * TILE_SIZE * SCALE, y * TILE_SIZE * SCALE, TILE_SIZE * SCALE, TILE_SIZE * SCALE);
        }
      }
      ctx.fillStyle = player.color;
      ctx.fillRect(player.x * TILE_SIZE * SCALE, player.y * TILE_SIZE * SCALE, TILE_SIZE * SCALE, TILE_SIZE * SCALE);
    }

    function gameLoop() {
      update();
      draw();
      requestAnimationFrame(gameLoop);
    }

    // Iniciar
    requestAnimationFrame(gameLoop);
  </script>
</body>
</html>
